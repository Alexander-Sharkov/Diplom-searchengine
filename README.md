# Локальный поисковый движок по сайту

Поисковый движок представляет собой Spring-приложение, работающее с локально установленной базой данных MySQL, 
имеющее простой веб-интерфейс и API, через который им можно управлять и получать результаты поисковой выдачи по запросу.

## Принципы работы поискового движка

* В конфигурационном файле перед запуском приложения задаются адреса сайтов, по которым движок должен осуществлять 
  поиск.
* Поисковый движок самостоятельно обходить все страницы заданных сайтов и индексирует их так, чтобы потом находить
  наиболее релевантные страницы по любому поисковому запросу.
* Пользователь присылает запрос через API движка. 
* Запрос определённым образом трансформируется в список слов, переведённых в базовую форму. Например, для 
  существительных — именительный падеж, единственное число.
* В индексе ищутся страницы, на которых встречаются все эти слова.
* Результаты поиска ранжируются, сортируются и отдаются пользователю.

## Технологии
* Проект реализован на основе Spring Boot и сборщика Maven
* Используется шаблонизатор Thymeleaf и библиотека Lombok
* Для парсинга сайтов используется библиотека JSOUP

## Настройки для запуска

### Настройки подключения к БД

В проект добавлен драйвер для подключения к БД MySQL. Для запуска проекта,
убедитесь, что у вас запущен сервер MySQL 

Создайте в бд `search_engine` и замените логин и пароль в файле конфигурации `src/application.yml`:

### Библиотека JSOUP
Рекомендуется установить корректное значение User-Agent и referrer в файле конфигурации `src/application.yml`,
например HeliontSearchBot (поисковый бот Heliont),
где Heliont — пример названия поискового движка, которое вы можете дать самостоятельно

Также рекомендуется установка timeout - некоторые сайты могут быть защищены от слишком частых запросов:
их необходимо обходить аккуратно, с задержками в 0,5–5 секунд между запросами.

### Список сайтов
Пропишите в конфигурации приложения список из одного или двух сайтов для парсинга
url путь к сайту и его название

Возможен парсинг определенных категорий https://et-cetera.ru/mobile/ 
тогда другие страницы попадать в результат не будут

Если сайт содержит большое кол-во статей, работа будет продолжительна - рекомендуется делать запись в бд на SSD диск

### Лемматизатор

Используется лемматизатор https://github.com/akuznetsov/russianmorphology,
который используется в поисковом движке Apache Solr 

Так как для доступа требуется авторизации по токену для получения данных из
публичного репозитория, для указания токена, найдите файл `settings.xml`.

* В Windows он располагается в директории `C:/Users/<Имя вашего пользователя>/.m2`
* В Linux директория `/home/<Имя вашего пользователя>/.m2`
* В macOs по адресу `/Users/<Имя вашего пользователя>/.m2`

И добавьте внутри тега `settings` текст конфигурации 
(Если файла нет, то создайте `settings.xml` и вставьте в него):

```xml
<settings xmlns="http://maven.apache.org/SETTINGS/1.0.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/SETTINGS/1.0.0
 https://maven.apache.org/xsd/settings-1.0.0.xsd">

  <servers>
    <server>
      <id>skillbox-gitlab</id>
      <configuration>
        <httpHeaders>
          <property>
            <name>Private-Token</name>
            <value>wtb5axJDFX9Vm_W1Lexg</value>
          </property>
        </httpHeaders>
      </configuration>
    </server>
  </servers>

</settings>
```

## Работа с Веб-интерфейсом

* Приложение запускается по умолчанию через порт по адресу: http://localhost:8080/
* Если порт занят измените в файле конфигурации `src/application.yml`
```
server:
  port: 8080
```
* Вкладка Dashboard открывается по умолчанию. На ней отображается общая статистика по всем сайтам,
  а также детальная статистика и статус по каждому из сайтов

* На вкладке Management находятся инструменты управления поисковым движком — запуск и
  остановка полной индексации (переиндексации), а также возможность добавить (обновить) отдельную страницу по ссылке

* Вкладка Search предназначена для тестирования поискового движка.
  На ней находится поле поиска, выпадающий список с выбором сайта для поиска,
  а при нажатии на кнопку «Найти» выводятся результаты поиска

